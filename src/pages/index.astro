---
import { getCollection } from "astro:content";
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import LinkButton from "@components/LinkButton.astro";
import Hr from "@components/Hr.astro";
import Card from "@components/Card";
import Socials from "@components/Socials.astro";
import getSortedPosts from "@utils/getSortedPosts";
import { SOCIALS } from "@config";

const posts = await getCollection("blog");

const sortedPosts = getSortedPosts(posts);
const featuredPosts = sortedPosts.filter(({ data }) => data.featured);
const recentPosts = sortedPosts.filter(({ data }) => !data.featured);

const socialCount = SOCIALS.filter(social => social.active).length;
---

<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<Layout>
  <Header />
  <main id="main-content">
    <section id="hero">
      <h1>Sora Ai</h1>
      <!-- <a
        target="_blank"
        href="/rss.xml"
        class="rss-link"
        aria-label="rss feed"
        title="RSS Feed"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="rss-icon"
          ><path
            d="M19 20.001C19 11.729 12.271 5 4 5v2c7.168 0 13 5.832 13 13.001h2z"
          ></path><path
            d="M12 20.001h2C14 14.486 9.514 10 4 10v2c4.411 0 8 3.589 8 8.001z"
          ></path><circle cx="6" cy="18" r="2"></circle>
        </svg>
        <span class="sr-only">RSS Feed</span>
      </a> -->

      <h2>Try OpenAI Sora</h2>
      <h2>
        Creating video from text/image, generating loop video, extending video
        forward and backward
      </h2>
      <h2>Be the first to know when Sora is live! Join the waitlist !</h2>

      <form id="subscribe-form">
        <input
          type="email"
          id="email"
          placeholder="Enter your email"
          required
        />
        <button type="submit">Subscribe</button>
      </form>

      <div id="success-message" style="display: none;">
        <p>Success! Thanks for joining us!</p>
      </div>

      <script>
        function handleFormSubmit(event) {
          event.preventDefault();
          var emailInput = event.target.querySelector("#email");
          var email = emailInput.value;
          // 这里可以添加邮箱验证等操作

          showSuccessMessage();
        }

        function showSuccessMessage() {
          var successMessage = document.getElementById("success-message");
          successMessage.style.display = "block";
          setTimeout(function () {
            successMessage.style.display = "none";
          }, 3000); // 3秒后隐藏消息
        }

        document.addEventListener("DOMContentLoaded", function () {
          // 检查会话存储中是否包含订阅成功的状态
          var subscribed = sessionStorage.getItem("subscribed");
          if (subscribed === "true") {
            showSuccessMessage();
          }

          // 在页面加载后重新绑定事件监听器
          document.addEventListener("submit", function (event) {
            if (event.target && event.target.id === "subscribe-form") {
              handleFormSubmit(event);
            }
          });
        });

        // 在离开页面时，将订阅成功的状态保存到会话存储中
        window.addEventListener("beforeunload", function () {
          sessionStorage.setItem("subscribed", "true");
        });
      </script>
    </section>
  </main>

  <head>
    <style>
      /* 设置视频容器的样式 */
      #video-container {
        max-width: 1100px; /* 设置父容器的最大宽度为 1100px */
        margin: 0 auto; /* 将视频容器居中 */
        display: flex; /* 使用 Flexbox 布局 */
        flex-wrap: wrap; /* 允许元素换行 */
        justify-content: flex-start; /* 水平间距相等 */
        gap: 20px; /* 设置视频元素之间的水平间距 */
      }

      /* 设置视频元素的样式 */
      .video-item {
        width: calc((100% - 40px) / 3); /* 每行显示3个视频，减去间距 */
        margin-bottom: 60px; /* 设置视频元素之间的垂直间距 */
        height: 300px; /* 视频容器的高度 */
      }

      video {
        width: 500px; /* 视频元素占满父容器的宽度 */
        height: 300px; /* 视频元素占满父容器的高度 */
        object-fit: cover; /* 确保视频铺满整个视频框 */
      }

      Layout h2:nth-of-type(1) {
        position: relative; /* 设置标题为相对定位 */
        left: 900px; /* 设置标题的左边距为视频容器的左边距的负值 */
      }
    </style>
  </head>

  <body>
    <h2>OpenAI官网视频</h2>

    <!-- 使用一个容器包裹视频元素 -->
    <div id="video-container">
      <!-- 第一个视频元素 -->
      <div class="video-item">
        <video controls>
          <source
            src="https://cdn.openai.com/tmp/s/sampling_1.mp4"
            type="video/mp4"
          />
          Your browser does not support the video tag.
        </video>
        <span class="video-caption">提示词文字1</span>
        <!-- 添加提示词文字 -->
      </div>

      <!-- 第二个视频元素 -->
      <div class="video-item">
        <video controls>
          <source
            src="https://cdn.openai.com/tmp/s/sampling_2.mp4"
            type="video/mp4"
          />
          Your browser does not support the video tag.
        </video>
        <span class="video-caption">提示词文字1</span>
        <!-- 添加提示词文字 -->
      </div>

      <!-- 第三个视频元素 -->
      <div class="video-item">
        <video controls>
          <source
            src="https://cdn.openai.com/tmp/s/sampling_3.mp4"
            type="video/mp4"
          />
          Your browser does not support the video tag.
        </video>
      </div>

      <!-- 第四个视频元素 -->
      <div class="video-item">
        <video controls>
          <source
            src="https://cdn.openai.com/tmp/s/sampling_4.mp4"
            type="video/mp4"
          />
          Your browser does not support the video tag.
        </video>
      </div>

      <!-- 第五个视频元素 -->
      <div class="video-item">
        <video controls>
          <source
            src="https://cdn.openai.com/tmp/s/sampling_5.mp4"
            type="video/mp4"
          />
          Your browser does not support the video tag.
        </video>
      </div>

      <!-- 第六个视频元素 -->
      <div class="video-item">
        <video controls>
          <source
            src="https://cdn.openai.com/tmp/s/sampling_6.mp4"
            type="video/mp4"
          />
          Your browser does not support the video tag.
        </video>
      </div>

      <!-- 在这里添加更多视频元素 -->
    </div>
  </body>

  <Hr />

  {
    featuredPosts.length > 0 && (
      <>
        <section id="featured">
          <h2>Featured</h2>
          <ul>
            {featuredPosts.map(({ data, slug }) => (
              <Card
                href={`/posts/${slug}/`}
                frontmatter={data}
                secHeading={false}
              />
            ))}
          </ul>
        </section>
        {recentPosts.length > 0 && <Hr />}
      </>
    )
  }

  {
    recentPosts.length > 0 && (
      <section id="recent-posts">
        <h2>The latest news about Sora</h2>
        <ul>
          {recentPosts.map(
            ({ data, slug }, index) =>
              index < 4 && (
                <Card
                  href={`/posts/${slug}/`}
                  frontmatter={data}
                  secHeading={false}
                />
              )
          )}
        </ul>
      </section>
    )
  }

  <div class="all-posts-btn-wrapper">
    <LinkButton href="/posts/">
      All Posts
      <svg xmlns="http://www.w3.org/2000/svg"
        ><path
          d="m11.293 17.293 1.414 1.414L19.414 12l-6.707-6.707-1.414 1.414L15.586 11H6v2h9.586z"
        ></path>
      </svg>
    </LinkButton>
  </div>
  <Footer />
</Layout>

<style>
  /* ===== Hero Section ===== */

  /* 设置第一个 h2 元素的字体为 Arial，颜色为红色 */
  #hero h2:nth-of-type(1) {
    font-family: Arial, sans-serif;
    color: red;
    font-size: 25px; /* 设置字体大小为 16 像素 */
    margin-bottom: 0px;
    text-align: left;
  }

  /* 设置第二个 h2 元素的字体为 Helvetica，颜色为绿色 */

  #hero h2:nth-of-type(2) {
    font-family: Helvetica, sans-serif;
    color: green;
    font-size: 22px; /*设置字体大小为 16 像素 */
    margin-bottom: 10px;
    text-align: left;
    white-space: pre-wrap;
  }

  /* 设置第三个 h2 元素的字体为 Times New Roman，颜色为蓝色 */
  #hero h2:nth-of-type(3) {
    font-family: "Times New Roman", serif;
    color: green;
    font-size: 22px; /* 设置字体大小为 16 像素 */
    margin-bottom: 10px;
  }

  /* 修改输入框的边框样式 */
  #subscribe-form #email {
    border: 2px solid #00f; /* 设置边框宽度为2px，颜色为蓝色 */
    outline: none; /* 移除输入框的聚焦时的边框样式 */
    padding: 8px; /* 设置内边距 */
    border-radius: 4px; /* 设置边框圆角 */
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); /* 设置阴影效果 */
  }

  /* 修改按钮的颜色和背景色 */
  #subscribe-form button {
    color: #fff; /* 设置文字颜色为白色 */
    background-color: #f00; /* 设置背景色为红色 */
    border: none; /* 移除按钮的边框 */
    padding: 8px 16px; /* 设置内边距 */
    border-radius: 4px; /* 设置边框圆角 */
    cursor: pointer; /* 设置鼠标样式为手型 */
    transition: background-color 0.3s ease; /* 设置背景色变化的过渡效果 */
  }

  /* 鼠标悬停时修改按钮的背景色 */
  #subscribe-form button:hover {
    background-color: #d00; /* 设置悬停时的背景色为深红色 */
  }

  #success-message {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 20px;
    background-color: rgb(211, 211, 211);
    border: 2px solid rgba(255, 0, 234, 0.692);
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  }
  #success-message p {
    color: RED; /* 文本颜色为蓝色 */
    font-family: Arial, sans-serif; /* 字体为 Arial 或者 sans-serif（无衬线字体） */
  }

  #main-content {
    margin: 0 auto; /* 将左右外边距设置为自动，实现水平居中 */
  }
  #hero h2:nth-of-type(4) {
    position: relative; /* 设置标题为相对定位 */
    left: 1000px; /* 设置标题的左边距为视频容器的左边距的负值 */
  }

  #hero {
    @apply pb-6 pt-8;
    width: 6xl; /* 或者是其他你想要设置的具体宽度值，如 width: 800px; */
    margin: 0 auto; /* 设置上下边距为 0，左右边距为 auto，实现水平居中 */
  }
  #hero h1 {
    @apply my-4 inline-block text-3xl font-bold sm:my-8 sm:text-5xl;

    text-align: center;
    font-family: Arial, sans-serif;
  }
  #hero .rss-link {
    @apply mb-6;
  }
  #hero .rss-icon {
    @apply mb-2 h-6 w-6 scale-110 fill-skin-accent sm:mb-3 sm:scale-125;
  }
  #hero p {
    @apply my-2;
  }
  .social-wrapper {
    @apply mt-4 flex flex-col sm:flex-row sm:items-center;
  }
  .social-links {
    @apply mb-1 mr-2 whitespace-nowrap sm:mb-0;
  }

  /* ===== Featured & Recent Posts Sections ===== */
  #featured,
  #recent-posts {
    @apply pb-6 pt-12;
  }
  #featured h2,
  #recent-posts h2 {
    @apply text-2xl font-semibold tracking-wide;
    text-align: center; /* 新增的样式，使文本居中显示 */
  }
  .all-posts-btn-wrapper {
    @apply my-8 text-center;
  }
</style>
